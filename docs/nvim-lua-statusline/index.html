<!DOCTYPE html>
<html lang="en-us">
  <head>
    <link href="http://gmpg.org/xfn/11" rel="profile" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />

    <title>
      Rolling Your Own Neovim Statusline in Lua &#183; nihilistkitten
    </title>

    <link
      rel="stylesheet"
      href="rileyshahar.github.io/style.css"
    />

    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@300&family=Lato:wght@300&display=swap"
    />

    <link rel="shortcut icon" href="rileyshahar.github.io/images/favicon.ico" />
    <link rel="apple-touch-icon" sizes="48x48" href="[object]" /> <link rel="apple-touch-icon"
    sizes="72x72" href="[object]" /> <link rel="apple-touch-icon"
    sizes="96x96" href="[object]" /> <link rel="apple-touch-icon"
    sizes="144x144" href="[object]" /> <link rel="apple-touch-icon"
    sizes="192x192" href="[object]" /> <link rel="apple-touch-icon"
    sizes="256x256" href="[object]" /> <link rel="apple-touch-icon"
    sizes="384x384" href="[object]" /> <link rel="apple-touch-icon"
    sizes="512x512" href="[object]" />

    <!-- seo tags -->
             

    <meta name="author" content="Riley Shahar" />
    <meta
      name="generator"
      content="Zola 0.13"
    />
    <meta property="og:site_name" content="nihilistkitten" />

    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary" />

    

    <meta property="og:title" content="Rolling Your Own Neovim Statusline in Lua" />
    <meta property="twitter:title" content="Rolling Your Own Neovim Statusline in Lua" />

    <meta name="description" content="&lt;p&gt;I’ve recently been rewriting my &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rileyshahar&#x2F;dotfiles&#x2F;tree&#x2F;main&#x2F;nvim&quot;&gt;neovim dotfiles&lt;&#x2F;a&gt; in lua. One of the things I wanted to do was reduce my plugin dependencies&lt;sup class=&quot;footnote&quot;&gt;&lt;span class=&quot;fn-outer-wrapper&quot;&gt;&lt;span class=&quot;fn-inner-wrapper&quot;&gt;I only partially succeeded at this, unfortunately - I like cool toys too much.&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;sup&gt;
, so rolling my own statusline seemed logical. I thought I’d write some quick documentation of my experience - most of this article is just a guided tour through the relevant help pages, but maybe it’ll be helpful anyway.&lt;&#x2F;p&gt;
" />
    <meta name="og:description" content="&lt;p&gt;I’ve recently been rewriting my &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rileyshahar&#x2F;dotfiles&#x2F;tree&#x2F;main&#x2F;nvim&quot;&gt;neovim dotfiles&lt;&#x2F;a&gt; in lua. One of the things I wanted to do was reduce my plugin dependencies&lt;sup class=&quot;footnote&quot;&gt;&lt;span class=&quot;fn-outer-wrapper&quot;&gt;&lt;span class=&quot;fn-inner-wrapper&quot;&gt;I only partially succeeded at this, unfortunately - I like cool toys too much.&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;sup&gt;
, so rolling my own statusline seemed logical. I thought I’d write some quick documentation of my experience - most of this article is just a guided tour through the relevant help pages, but maybe it’ll be helpful anyway.&lt;&#x2F;p&gt;
" />
    <meta name="twitter:description" content="&lt;p&gt;I’ve recently been rewriting my &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rileyshahar&#x2F;dotfiles&#x2F;tree&#x2F;main&#x2F;nvim&quot;&gt;neovim dotfiles&lt;&#x2F;a&gt; in lua. One of the things I wanted to do was reduce my plugin dependencies&lt;sup class=&quot;footnote&quot;&gt;&lt;span class=&quot;fn-outer-wrapper&quot;&gt;&lt;span class=&quot;fn-inner-wrapper&quot;&gt;I only partially succeeded at this, unfortunately - I like cool toys too much.&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;sup&gt;
, so rolling my own statusline seemed logical. I thought I’d write some quick documentation of my experience - most of this article is just a guided tour through the relevant help pages, but maybe it’ll be helpful anyway.&lt;&#x2F;p&gt;
" />

    <link rel="canonical" href="rileyshahar.github.io&#x2F;nvim-lua-statusline&#x2F;" />
    <meta property="og:url" content="rileyshahar.github.io&#x2F;nvim-lua-statusline&#x2F;" />

		<!-- mathjax -->
		<script>
			MathJax = {
				tex: {
					inlineMath: [ ['$', '$'], ['\\(', '\\)'] ]
					displayMath: [ ['$$','$$'], ["\\[","\\]"], ]
				}
			};
		</script>
		<script type="text/javascript" async
			src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
		</script>
  </head>
  <body class="dark-theme">
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox" />

    <div class="sidebar" id="sidebar">
      <div class="sidebar-item">
        <label class="switch" title="Toggle Darkmode" float="left" style="vertical-align: middle;">
          <input id="darkmode-slider" type="checkbox" />
          <a
            class="slider"
            onclick="toggleDarkMode()"
            id="darkmode-slider-actual"
          ></a>
        </label>
        <a
          class="button circle-button"
          title="Mail Me!"
          rel="author"
          id="mail-button"
          href="mailto:riley.shahar@gmail.com"
          style="vertical-align: middle;"
        ></a>
        <a
          class="button circle-button"
          title="Github"
          rel="author"
          id="github-button"
          href="https://github.com/rileyshahar"
          style="vertical-align: middle;"
        ></a>
        <a
          class="button circle-button"
          title="Resume"
          rel="author"
          id="resume-button"
          href="rileyshahar.github.io/resume.html"
          style="vertical-align: middle;"
        ></a>
      </div>

      <div class="sidebar-item">
        <p>Hi! I&#x27;m Riley. My pronouns are she&#x2F;they. This site serves two purposes: an excuse to play with random web technologies, and a tool to scream meaninglessly into the void.</p>
        <p>The quote in the header is from the 11th doctor, if you care.</p>
      </div>

      <nav class="sidebar-nav">
        <a class="sidebar-nav-item" href="rileyshahar.github.io" >Home</a>
        <a class="sidebar-nav-item" href="rileyshahar.github.io/tags" >Tags</a>
      </nav>


      <div class="sidebar-item" style="font-size: 0.75em;">
        <p>
          Built with <a href="https://www.getzola.org/">Zola</a>. Style from
          <a href="https://lanyon.getpoole.com">Lanyon</a>. The source for this
          blog is available on
          <a href="https://github.com/rileyshahar/rileyshahar.github.io">GitHub</a>.
        </p>
        <p>
          &copy; 2021 Riley Shahar. This work is licensed under a
          <a
            rel="license"
            href="http://creativecommons.org/licenses/by-nc-sa/4.0/"
            style="color: inherit;"
            >Creative Commons Attribution-NonCommercial-ShareAlike 4.0
            International License</a
          >. Any code samples are licensed under the
          <a
            rel="license"
            href="https://opensource.org/licenses/MIT"
            style="color: inherit;"
            >MIT License</a
          >
          unless otherwise stated.
        </p>
      </div>
    </div>

    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="rileyshahar.github.io/" title="Home">nihilistkitten</a>
            <small>we're all stories in the end; just make it a good one</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        

<div class="post">
  
  <h1 class="post-title">
    <a href="rileyshahar.github.io&#x2F;nvim-lua-statusline&#x2F;">
      Rolling Your Own Neovim Statusline in Lua
    </a>
  </h1>
  <span class="post-date">
    2021-04-27
    
      &#183; 
    
      <a class="tag" href="rileyshahar.github.io/tags/neovim/">neovim</a>,
    
      <a class="tag" href="rileyshahar.github.io/tags/development/">development</a>,
    
      <a class="tag" href="rileyshahar.github.io/tags/tech/">tech</a>
    

    
  </span>


  <p>I’ve recently been rewriting my <a href="https://github.com/rileyshahar/dotfiles/tree/main/nvim">neovim dotfiles</a> in lua. One of the things I wanted to do was reduce my plugin dependencies<sup class="footnote"><span class="fn-outer-wrapper"><span class="fn-inner-wrapper">I only partially succeeded at this, unfortunately - I like cool toys too much.</span></span></sup>
, so rolling my own statusline seemed logical. I thought I’d write some quick documentation of my experience - most of this article is just a guided tour through the relevant help pages, but maybe it’ll be helpful anyway.</p>
<span id="continue-reading"></span>
<p>Let’s start by looking at what neovim gives us out of the box<sup class="footnote"><span class="fn-outer-wrapper"><span class="fn-inner-wrapper">Yes, I did choose a rust file ~~so I could pretend to be halfway competent~~ because that&#x27;s *definitely* what I write most often.</span></span></sup>
:</p>
<p><img src="rileyshahar.github.io/nvim-lua-statusline/initial-statusline.png" alt="White text on a blue background reading src/tournament/from_url.rs, then a gap, then 8,6, then another gap, then Top" /></p>
<p>This is the file path from vim’s current working directory (<code>:h current-directory</code>), the current line and column number, and some information about how far we are through the file<sup class="footnote"><span class="fn-outer-wrapper"><span class="fn-inner-wrapper">In fact, it gives you a little more info not shown here - a little [+] will show up next to the filename once modified, for instance. But that&#x27;s not super relevant to what we&#x27;re doing, and I don&#x27;t want to take a screenshot of every possible permutation of the statusline.</span></span></sup>
.</p>
<h2 id="modifying-the-statusline">Modifying the Statusline</h2>
<p>Let’s start with something basic: how do we change the statusline at all? For instance, let’s say we want to write a static string.</p>
<p>Well, as always with (neo)vim, our first resource should be the help pages. <code>:h statusline</code> tells us that:</p>
<blockquote>
<p>When nonempty, this option determines the content of the status line.</p>
</blockquote>
<p>Hm, ok, it seems like there’s a statusline option<sup class="footnote"><span class="fn-outer-wrapper"><span class="fn-inner-wrapper">Vim options are a little outside the scope of this article, but there are great resources online, starting with the help page, `:h option`.</span></span></sup>
 we can set. So I guess we can just do that:</p>
<pre data-lang="lua" style="background-color:#2b303b;color:#c0c5ce;" class="language-lua "><code class="language-lua" data-lang="lua"><span style="color:#bf616a;">vim</span><span>.o.statusline = &quot;</span><span style="color:#a3be8c;">Hello, world!</span><span>&quot;
</span></code></pre>
<p>And, indeed:</p>
<p><img src="rileyshahar.github.io/nvim-lua-statusline/hello-world-statusline.png" alt="The words “Hello, world!” on the same dark blue background." /></p>
<h2 id="dynamic-content">Dynamic Content</h2>
<p>So, statuslines aren’t useful if they don’t change. Let’s read on in the help:</p>
<blockquote>
<p>The option consists of printf style ‘%’ items interspersed with normal text. Each status line item is of the form:</p>
<p><code>%-0{minwid}.{maxwid}{item}</code></p>
<p>All fields except the {item} are optional. A single percent sign can be given as “%%”.</p>
</blockquote>
<p>We can ignore most of these fields (for now) - they’re described in more detail later in the help page, if you’re interested. What’s important for us is the list of items, which is right underneath. There’s a lot, so I won’t reproduce them here. Let’s look at a few simple ones:</p>
<table><thead><tr><th>item</th><th>help description</th></tr></thead><tbody>
<tr><td>f</td><td>Path to the file in the buffer, as typed or relative to current directory.</td></tr>
<tr><td>m</td><td>Modified flag, text is “[+]”; “[-]” if ‘modifiable’ is off.</td></tr>
<tr><td>r</td><td>Readonly flag, text is “[RO]”.</td></tr>
<tr><td>y</td><td>Type of file in the buffer, e.g., “[vim]”. See ‘filetype’.</td></tr>
<tr><td>l</td><td>Line number.</td></tr>
<tr><td>c</td><td>Column number.</td></tr>
<tr><td>p</td><td>Percentage through file in lines as in CTRL-G.</td></tr>
</tbody></table>
<p>Great, so we can now write a simple dynamic statusline:</p>
<pre data-lang="lua" style="background-color:#2b303b;color:#c0c5ce;" class="language-lua "><code class="language-lua" data-lang="lua"><span style="color:#bf616a;">vim</span><span>.o.statusline = &quot;</span><span style="color:#a3be8c;">%f | %l,%c | %p%%</span><span>&quot;
</span></code></pre>
<p><img src="rileyshahar.github.io/nvim-lua-statusline/simple-dynamic-statusline.png" alt="The same light text on dark blue; it reads src/tournament/from_url.rs | 8,6 | 2%, and is all aligned to the left. " /></p>
<h2 id="alignment">Alignment</h2>
<p>Ok, but, we’re still not even better than the default statusline, which aligns the percentage number to the right, making better use of screen space. Again, the help comes to our rescue; it describes the <code>=</code> item as follows:</p>
<blockquote>
<p>Separation point between alignment sections. Each section will be separated by an equal number of spaces.</p>
</blockquote>
<p>Let’s try it:</p>
<pre data-lang="lua" style="background-color:#2b303b;color:#c0c5ce;" class="language-lua "><code class="language-lua" data-lang="lua"><span style="color:#bf616a;">vim</span><span>.o.statusline = &quot;</span><span style="color:#a3be8c;">%f %= %l,%c %= %p%%</span><span>&quot;
</span></code></pre>
<p>Great! We’ve created a rough (slightly less featureful) facsimile of the default statusline.</p>
<p><img src="rileyshahar.github.io/nvim-lua-statusline/aligned-statusline.png" alt="The same content as before, but instead of the pipes (|), the three sections are separated by spacing." /></p>
<p>Now, in vimscript, you typically wouldn’t write the whole statusline in one string like this. Instead, you’d do something like:</p>
<pre data-lang="vimscript" style="background-color:#2b303b;color:#c0c5ce;" class="language-vimscript "><code class="language-vimscript" data-lang="vimscript"><span>set statusline=
</span><span>set statusline+=%f
</span><span>set statusline+=%=
</span><span>set statusline+=%l,%c
</span><span>set statusline+=%=
</span><span>set statusline+=%p%%
</span></code></pre>
<p>We can simply emulate this in lua:</p>
<pre data-lang="lua" style="background-color:#2b303b;color:#c0c5ce;" class="language-lua "><code class="language-lua" data-lang="lua"><span style="color:#b48ead;">local </span><span style="color:#bf616a;">o </span><span>= </span><span style="color:#bf616a;">vim</span><span>.o
</span><span>
</span><span style="color:#bf616a;">o</span><span>.statusline = &quot;&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%f</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%l,%c</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%p%%</span><span>&quot;
</span></code></pre>
<p>This seems kind of janky because of the lack of a self-concatenation operator in lua, but it’ll be useful when we want to add more complicated items to our statusline. If you prefer, you can write this:</p>
<pre data-lang="lua" style="background-color:#2b303b;color:#c0c5ce;" class="language-lua "><code class="language-lua" data-lang="lua"><span style="color:#bf616a;">vim</span><span>.o.statusline = &quot;&quot;
</span><span>                  .. &quot;</span><span style="color:#a3be8c;">%f</span><span>&quot;
</span><span>                  .. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span>                  .. &quot;</span><span style="color:#a3be8c;">%l,%c</span><span>&quot;
</span><span>                  .. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span>                  .. &quot;</span><span style="color:#a3be8c;">%p%%</span><span>&quot;
</span></code></pre>
<p>This looks nice but is undone by luafmt, which wants to put all string concatenations on one line.</p>
<h2 id="adding-color">Adding Color</h2>
<p>Monochromatic statuslines are pretty boring. Fortunately, the help knows how to fix that:</p>
<blockquote>
<p># - Set highlight group. The name must follow and then a # again. Thus use %#HLname# for highlight group HLname. The same highlighting is used, also for the statusline of non-current windows.</p>
</blockquote>
<p>And so<sup class="footnote"><span class="fn-outer-wrapper"><span class="fn-inner-wrapper">I&#x27;ll skip the details of the `highlight` command; your colorscheme may define the necessary highlight groups, or you can try something like this. As far as I&#x27;m aware the lua highlighting apis aren&#x27;t quite there yet, so I recommend sticking with `vim.cmd` for now. Also, keep in mind that depending on your terminal&#x27;s color support you may need to use different options in place of `guifg` and `guibg`.</span></span></sup>
:</p>
<pre data-lang="lua" style="background-color:#2b303b;color:#c0c5ce;" class="language-lua "><code class="language-lua" data-lang="lua"><span style="color:#b48ead;">local </span><span style="color:#bf616a;">o </span><span>= </span><span style="color:#bf616a;">vim</span><span>.o
</span><span style="color:#b48ead;">local </span><span style="color:#bf616a;">cmd </span><span>= </span><span style="color:#bf616a;">vim</span><span>.cmd
</span><span>
</span><span style="color:#bf616a;">cmd </span><span>&quot;</span><span style="color:#a3be8c;">highlight StatusLeft guifg=red guibg=#32344a</span><span>&quot;
</span><span style="color:#bf616a;">cmd </span><span>&quot;</span><span style="color:#a3be8c;">highlight StatusMid guifg=green guibg=#32344a</span><span>&quot;
</span><span style="color:#bf616a;">cmd </span><span>&quot;</span><span style="color:#a3be8c;">highlight StatusRight guifg=blue guibg=#32344a</span><span>&quot;
</span><span>
</span><span style="color:#bf616a;">o</span><span>.statusline = &quot;&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusLeft#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%f</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusMid#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%l,%c</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusRight#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%p%%</span><span>&quot;
</span></code></pre>
<p><img src="rileyshahar.github.io/nvim-lua-statusline/color.png" alt="The same statusline, with the left text colored red, the middle green, and the right blue." /></p>
<p>Finally, just to clean this up a little, we can write a <code>highlight</code> wrapper:</p>
<pre data-lang="lua" style="background-color:#2b303b;color:#c0c5ce;" class="language-lua "><code class="language-lua" data-lang="lua"><span style="color:#b48ead;">local </span><span style="color:#bf616a;">o </span><span>= </span><span style="color:#bf616a;">vim</span><span>.o
</span><span style="color:#b48ead;">local </span><span style="color:#bf616a;">cmd </span><span>= </span><span style="color:#bf616a;">vim</span><span>.cmd
</span><span>
</span><span style="color:#b48ead;">local function </span><span style="color:#8fa1b3;">highlight</span><span>(group, fg, bg)
</span><span>    </span><span style="color:#bf616a;">cmd</span><span>(&quot;</span><span style="color:#a3be8c;">highlight </span><span>&quot; .. </span><span style="color:#bf616a;">group </span><span>.. &quot;</span><span style="color:#a3be8c;"> guifg=</span><span>&quot; .. </span><span style="color:#bf616a;">fg </span><span>.. &quot;</span><span style="color:#a3be8c;"> guibg=</span><span>&quot; .. </span><span style="color:#bf616a;">bg</span><span>)
</span><span style="color:#b48ead;">end
</span><span>
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusLeft</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">red</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusMid</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">green</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusRight</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">blue</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span>
</span><span style="color:#bf616a;">o</span><span>.statusline = &quot;&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusLeft#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%f</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusMid#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%l,%c</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusRight#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%p%%</span><span>&quot;
</span></code></pre>
<p>By the way, please don’t seriously use the ugly built-in colors, they’re just for demonstration.</p>
<h2 id="lua-components">Lua Components</h2>
<p>So far we’ve just translated from vimscript; let’s very naively try to include some lua code in our statusline - you likely already see the error:</p>
<pre data-lang="lua" style="background-color:#2b303b;color:#c0c5ce;" class="language-lua "><code class="language-lua" data-lang="lua"><span style="color:#b48ead;">local </span><span style="color:#bf616a;">fn </span><span>= </span><span style="color:#bf616a;">vim</span><span>.fn
</span><span style="color:#b48ead;">local </span><span style="color:#bf616a;">o </span><span>= </span><span style="color:#bf616a;">vim</span><span>.o
</span><span style="color:#b48ead;">local </span><span style="color:#bf616a;">cmd </span><span>= </span><span style="color:#bf616a;">vim</span><span>.cmd
</span><span>
</span><span style="color:#b48ead;">local function </span><span style="color:#8fa1b3;">highlight</span><span>(group, fg, bg)
</span><span>    </span><span style="color:#bf616a;">cmd</span><span>(&quot;</span><span style="color:#a3be8c;">highlight </span><span>&quot; .. </span><span style="color:#bf616a;">group </span><span>.. &quot;</span><span style="color:#a3be8c;"> guifg=</span><span>&quot; .. </span><span style="color:#bf616a;">fg </span><span>.. &quot;</span><span style="color:#a3be8c;"> guibg=</span><span>&quot; .. </span><span style="color:#bf616a;">bg</span><span>)
</span><span style="color:#b48ead;">end
</span><span>
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusLeft</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">red</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusMid</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">green</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusRight</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">blue</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span>
</span><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">get_column_number</span><span>()
</span><span>    </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">fn</span><span>.</span><span style="color:#bf616a;">col</span><span>(&quot;</span><span style="color:#a3be8c;">.</span><span>&quot;)
</span><span style="color:#b48ead;">end
</span><span>
</span><span style="color:#bf616a;">o</span><span>.statusline = &quot;&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusLeft#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%f</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusMid#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%l,</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. </span><span style="color:#bf616a;">get_column_number</span><span>()
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusRight#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%p%%</span><span>&quot;
</span></code></pre>
<p>At first, it looks like this works - until we realize it always shows column 1:</p>
<p><img src="rileyshahar.github.io/nvim-lua-statusline/init-time-function-eval.png" alt="A snippet of rust code with the statusline undeneath. The column number shows 1, despite the cursor being in the middle of the line." /></p>
<p>This is because we’re evaluating <code>fn.col</code> only once, at initialization. We need to dynamically evaluate our lua code every time the statusline is updated.</p>
<p>Well, the help page tells us how to do this in vimscript:</p>
<blockquote>
<p>When the option starts with “%!” then it is used as an expression, evaluated and the result is used as the option value. Example:</p>
<p><code>:set statusline=%!MyStatusLine()</code></p>
</blockquote>
<p>Ok, so, our statusline has to start with <code>%!</code>, and then vim will evaluate it as an expression<sup class="footnote"><span class="fn-outer-wrapper"><span class="fn-inner-wrapper">See `:h luaeval()`, which is how you evaluate lua in an expression context.</span></span></sup>
:</p>
<pre data-lang="lua" style="background-color:#2b303b;color:#c0c5ce;" class="language-lua "><code class="language-lua" data-lang="lua"><span style="color:#b48ead;">local </span><span style="color:#bf616a;">fn </span><span>= </span><span style="color:#bf616a;">vim</span><span>.fn
</span><span style="color:#b48ead;">local </span><span style="color:#bf616a;">o </span><span>= </span><span style="color:#bf616a;">vim</span><span>.o
</span><span style="color:#b48ead;">local </span><span style="color:#bf616a;">cmd </span><span>= </span><span style="color:#bf616a;">vim</span><span>.cmd
</span><span>
</span><span style="color:#b48ead;">local function </span><span style="color:#8fa1b3;">highlight</span><span>(group, fg, bg)
</span><span>    </span><span style="color:#bf616a;">cmd</span><span>(&quot;</span><span style="color:#a3be8c;">highlight </span><span>&quot; .. </span><span style="color:#bf616a;">group </span><span>.. &quot;</span><span style="color:#a3be8c;"> guifg=</span><span>&quot; .. </span><span style="color:#bf616a;">fg </span><span>.. &quot;</span><span style="color:#a3be8c;"> guibg=</span><span>&quot; .. </span><span style="color:#bf616a;">bg</span><span>)
</span><span style="color:#b48ead;">end
</span><span>
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusLeft</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">red</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusMid</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">green</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusRight</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">blue</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span>
</span><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">get_column_number</span><span>()
</span><span>    </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">fn</span><span>.</span><span style="color:#bf616a;">col</span><span>(&quot;</span><span style="color:#a3be8c;">.</span><span>&quot;)
</span><span style="color:#b48ead;">end
</span><span>
</span><span style="color:#bf616a;">o</span><span>.statusline = &quot;&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%!</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusLeft#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%f</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusMid#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%l,</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">luaeval(&#39;get_column_number()&#39;)</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusRight#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%p%%</span><span>&quot;
</span></code></pre>
<p><img src="rileyshahar.github.io/nvim-lua-statusline/invalid-expr.png" alt="An error message that reads “E15: Invalid expression: %#StatusLeft#%f%=%#StatusMid#%l,luaeval(‘get_column_number()’)%=%#StatusRight#%p%%”." /></p>
<p>(Sorry, mobile readers - not that any of these images have been great for you, but I’m sure this one is the worst of the bunch.)</p>
<p>Anyway, that error makes sense - it’s trying to evaluate the whole string as an expression. One solution is suggested by the help:</p>
<blockquote>
<p>The result can contain %{} items that will be evaluated too.</p>
<p>Note that the “%!” expression is evaluated in the context of the current window and buffer, while %{} items are evaluated in the context of the window that the statusline belongs to.</p>
</blockquote>
<pre data-lang="lua" style="background-color:#2b303b;color:#c0c5ce;" class="language-lua "><code class="language-lua" data-lang="lua"><span style="color:#b48ead;">local </span><span style="color:#bf616a;">fn </span><span>= </span><span style="color:#bf616a;">vim</span><span>.fn
</span><span style="color:#b48ead;">local </span><span style="color:#bf616a;">o </span><span>= </span><span style="color:#bf616a;">vim</span><span>.o
</span><span style="color:#b48ead;">local </span><span style="color:#bf616a;">cmd </span><span>= </span><span style="color:#bf616a;">vim</span><span>.cmd
</span><span>
</span><span style="color:#b48ead;">local function </span><span style="color:#8fa1b3;">highlight</span><span>(group, fg, bg)
</span><span>    </span><span style="color:#bf616a;">cmd</span><span>(&quot;</span><span style="color:#a3be8c;">highlight </span><span>&quot; .. </span><span style="color:#bf616a;">group </span><span>.. &quot;</span><span style="color:#a3be8c;"> guifg=</span><span>&quot; .. </span><span style="color:#bf616a;">fg </span><span>.. &quot;</span><span style="color:#a3be8c;"> guibg=</span><span>&quot; .. </span><span style="color:#bf616a;">bg</span><span>)
</span><span style="color:#b48ead;">end
</span><span>
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusLeft</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">red</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusMid</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">green</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusRight</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">blue</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span>
</span><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">get_column_number</span><span>()
</span><span>    </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">fn</span><span>.</span><span style="color:#bf616a;">col</span><span>(&quot;</span><span style="color:#a3be8c;">.</span><span>&quot;)
</span><span style="color:#b48ead;">end
</span><span>
</span><span style="color:#bf616a;">o</span><span>.statusline = &quot;&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusLeft#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%f</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusMid#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%l,</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%{luaeval(&#39;get_column_number()&#39;)}</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%#StatusRight#</span><span>&quot;
</span><span style="color:#bf616a;">o</span><span>.statusline = </span><span style="color:#bf616a;">o</span><span>.statusline .. &quot;</span><span style="color:#a3be8c;">%p%%</span><span>&quot;
</span></code></pre>
<p><img src="rileyshahar.github.io/nvim-lua-statusline/lua-working.png" alt="A working statusline, with the file path, the line and column numbers, and the percentage through the file." /></p>
<p>And this works, but wrapping all our lua funtions as <code>%{luaeval('foo()')}</code> is going to get tiring and ugly fast. Here’s what I propose<sup class="footnote"><span class="fn-outer-wrapper"><span class="fn-inner-wrapper">Shoutout to [this post](https:&#x2F;&#x2F;www.reddit.com&#x2F;r&#x2F;neovim&#x2F;comments&#x2F;kco3l3&#x2F;help_lua_statusline_the_stubborn_way&#x2F;) for inspiring this.</span></span></sup>
:</p>
<pre data-lang="lua" style="background-color:#2b303b;color:#c0c5ce;" class="language-lua "><code class="language-lua" data-lang="lua"><span style="color:#b48ead;">local </span><span style="color:#bf616a;">fn </span><span>= </span><span style="color:#bf616a;">vim</span><span>.fn
</span><span style="color:#b48ead;">local </span><span style="color:#bf616a;">o </span><span>= </span><span style="color:#bf616a;">vim</span><span>.o
</span><span style="color:#b48ead;">local </span><span style="color:#bf616a;">cmd </span><span>= </span><span style="color:#bf616a;">vim</span><span>.cmd
</span><span>
</span><span style="color:#b48ead;">local function </span><span style="color:#8fa1b3;">highlight</span><span>(group, fg, bg)
</span><span>    </span><span style="color:#bf616a;">cmd</span><span>(&quot;</span><span style="color:#a3be8c;">highlight </span><span>&quot; .. </span><span style="color:#bf616a;">group </span><span>.. &quot;</span><span style="color:#a3be8c;"> guifg=</span><span>&quot; .. </span><span style="color:#bf616a;">fg </span><span>.. &quot;</span><span style="color:#a3be8c;"> guibg=</span><span>&quot; .. </span><span style="color:#bf616a;">bg</span><span>)
</span><span style="color:#b48ead;">end
</span><span>
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusLeft</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">red</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusMid</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">green</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusRight</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">blue</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span>
</span><span style="color:#b48ead;">local function </span><span style="color:#8fa1b3;">get_column_number</span><span>()
</span><span>    </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">fn</span><span>.</span><span style="color:#bf616a;">col</span><span>(&quot;</span><span style="color:#a3be8c;">.</span><span>&quot;)
</span><span style="color:#b48ead;">end
</span><span>
</span><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">status_line</span><span>()
</span><span>    </span><span style="color:#b48ead;">local </span><span style="color:#bf616a;">statusline </span><span>= &quot;&quot;
</span><span>    </span><span style="color:#bf616a;">statusline </span><span>= </span><span style="color:#bf616a;">statusline </span><span>.. &quot;</span><span style="color:#a3be8c;">%#StatusLeft#</span><span>&quot;
</span><span>    </span><span style="color:#bf616a;">statusline </span><span>= </span><span style="color:#bf616a;">statusline </span><span>.. &quot;</span><span style="color:#a3be8c;">%f</span><span>&quot;
</span><span>    </span><span style="color:#bf616a;">statusline </span><span>= </span><span style="color:#bf616a;">statusline </span><span>.. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span>    </span><span style="color:#bf616a;">statusline </span><span>= </span><span style="color:#bf616a;">statusline </span><span>.. &quot;</span><span style="color:#a3be8c;">%#StatusMid#</span><span>&quot;
</span><span>    </span><span style="color:#bf616a;">statusline </span><span>= </span><span style="color:#bf616a;">statusline </span><span>.. &quot;</span><span style="color:#a3be8c;">%l,</span><span>&quot;
</span><span>    </span><span style="color:#bf616a;">statusline </span><span>= </span><span style="color:#bf616a;">statusline </span><span>.. </span><span style="color:#bf616a;">get_column_number</span><span>()
</span><span>    </span><span style="color:#bf616a;">statusline </span><span>= </span><span style="color:#bf616a;">statusline </span><span>.. &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;
</span><span>    </span><span style="color:#bf616a;">statusline </span><span>= </span><span style="color:#bf616a;">statusline </span><span>.. &quot;</span><span style="color:#a3be8c;">%#StatusRight#</span><span>&quot;
</span><span>    </span><span style="color:#bf616a;">statusline </span><span>= </span><span style="color:#bf616a;">statusline </span><span>.. &quot;</span><span style="color:#a3be8c;">%p%%</span><span>&quot;
</span><span>
</span><span>    </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">statusline
</span><span style="color:#b48ead;">end
</span><span>
</span><span style="color:#bf616a;">o</span><span>.statusline = &quot;</span><span style="color:#a3be8c;">%!luaeval(&#39;status_line()&#39;)</span><span>&quot;
</span></code></pre>
<p>And you can start using lua to your heart’s desire! If there’s interest, I can write a list of useful APIs; my <a href="https://github.com/nihilistkitten/dotfiles/blob/main/nvim/lua/statusline.lua">statusline</a> uses <code>vim.bo.modified</code>, <code>vim.bo.readonly</code>, <code>vim.lsp.diagnostic.get_count</code>, <code>vim.fn.mode</code>, <code>vim.bo.filetype</code>, and <code>vim.b.gitsigns_status</code> from the <a href="https://github.com/lewis6991/gitsigns.nvim">gitsigns</a> plugin.</p>
<h2 id="addendum">Addendum</h2>
<p>u/TDplay on <a href="https://www.reddit.com/r/neovim/comments/n06p47/rolling_your_own_neovim_statusline_in_lua/gw6gshn/?utm_source=reddit&amp;utm_medium=web2x&amp;context=3">reddit</a> suggested a better solution to concatenate all the statusline elements: <code>table.concat</code>. Try this:</p>
<pre data-lang="lua" style="background-color:#2b303b;color:#c0c5ce;" class="language-lua "><code class="language-lua" data-lang="lua"><span style="color:#b48ead;">local </span><span style="color:#bf616a;">fn </span><span>= </span><span style="color:#bf616a;">vim</span><span>.fn
</span><span style="color:#b48ead;">local </span><span style="color:#bf616a;">o </span><span>= </span><span style="color:#bf616a;">vim</span><span>.o
</span><span style="color:#b48ead;">local </span><span style="color:#bf616a;">cmd </span><span>= </span><span style="color:#bf616a;">vim</span><span>.cmd
</span><span>
</span><span style="color:#b48ead;">local function </span><span style="color:#8fa1b3;">highlight</span><span>(group, fg, bg)
</span><span>    </span><span style="color:#bf616a;">cmd</span><span>(&quot;</span><span style="color:#a3be8c;">highlight </span><span>&quot; .. </span><span style="color:#bf616a;">group </span><span>.. &quot;</span><span style="color:#a3be8c;"> guifg=</span><span>&quot; .. </span><span style="color:#bf616a;">fg </span><span>.. &quot;</span><span style="color:#a3be8c;"> guibg=</span><span>&quot; .. </span><span style="color:#bf616a;">bg</span><span>)
</span><span style="color:#b48ead;">end
</span><span>
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusLeft</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">red</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusMid</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">green</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span style="color:#bf616a;">highlight</span><span>(&quot;</span><span style="color:#a3be8c;">StatusRight</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">blue</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">#32344a</span><span>&quot;)
</span><span>
</span><span style="color:#b48ead;">local function </span><span style="color:#8fa1b3;">get_column_number</span><span>()
</span><span>    </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">fn</span><span>.</span><span style="color:#bf616a;">col</span><span>(&quot;</span><span style="color:#a3be8c;">.</span><span>&quot;)
</span><span style="color:#b48ead;">end
</span><span>
</span><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">status_line</span><span>()
</span><span>    </span><span style="color:#b48ead;">return </span><span>table.</span><span style="color:#96b5b4;">concat </span><span>{
</span><span>        &quot;</span><span style="color:#a3be8c;">%#StatusLeft#</span><span>&quot;,
</span><span>        &quot;</span><span style="color:#a3be8c;">%f</span><span>&quot;,
</span><span>        &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;,
</span><span>        &quot;</span><span style="color:#a3be8c;">%#StatusMid#</span><span>&quot;,
</span><span>        &quot;</span><span style="color:#a3be8c;">%l,</span><span>&quot;,
</span><span>        </span><span style="color:#bf616a;">get_column_number</span><span>(),
</span><span>        &quot;</span><span style="color:#a3be8c;">%=</span><span>&quot;,
</span><span>        &quot;</span><span style="color:#a3be8c;">%#StatusRight#</span><span>&quot;,
</span><span>        &quot;</span><span style="color:#a3be8c;">%p%%</span><span>&quot;
</span><span>    }
</span><span style="color:#b48ead;">end
</span><span>
</span><span style="color:#bf616a;">vim</span><span>.o.statusline = &quot;</span><span style="color:#a3be8c;">%!luaeval(&#39;status_line()&#39;)</span><span>&quot;
</span></code></pre>
<p>And rejoice at the substantially improved readability!</p>

</div>

      </div>
    </div>

    <label title="Toggle Sidebar" for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src="rileyshahar.github.io/js/sidebar.js"></script>
  </body>
</html>
